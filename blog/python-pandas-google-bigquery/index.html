<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.bed2efcca611a7619966.css">@import url(https://fonts.googleapis.com/css?family=Bitter:400,400i|Maven+Pro:400,500,700|Open+Sans:400,400i,600,600i,700,700i&display=swap);nav{background-color:hsla(0,0%,100%,.9)!important}.uk-navbar-container a{font-family:Maven Pro,Helvetica,sans-serif!important;font-size:.8em!important;min-width:120px;text-align:center}.uk-navbar-container a.uk-active{color:#333;font-weight:600;text-decoration:overline}.anim-nav-container{position:fixed;top:0;left:0;z-index:2;display:grid;grid-template-columns:repeat(1,minmax(100px,1fr));grid-gap:1px;padding:0;cursor:pointer;will-change:width,height}.anim-nav-item{width:100%;height:100%;background:#000;will-change:transform}a{cursor:pointer!important}.uk-navbar-container{height:60px!important;margin:0!important;padding:0!important}nav img{min-width:60px}nav .uk-navbar-item{min-height:65px}nav .uk-navbar-toggle,nav li a{min-height:60px!important}a.home-icon{color:#888!important}a.hide-home-icon{display:none!important}#modal-root{position:fixed;z-index:999}.modal-background{background-color:rgba(0,0,0,.35);position:fixed;top:0;height:100vh;width:100vw;z-index:1}.modal-container{display:flex;flex-direction:column;justify-content:flex-start;height:100vh}.fullscreen-card .uk-card{padding-top:24px!important;height:100%;display:flex;flex-direction:column;justify-content:center}.fullscreen-card .uk-card-body{height:85%;overflow-y:scroll!important}.notification-card .uk-card{position:relative;display:flex;flex-direction:column;justify-content:space-around;border-radius:4px;margin:auto 24px}.modal-container .uk-card-footer{position:absolute;background-color:#fff;height:32px;bottom:24px;left:0;right:0}.modal-close-button{position:absolute;z-index:5;right:10px}.fullscreen-card .modal-close-button{top:55px}.notification-card .modal-close-button{top:10px}body{margin:0;position:relative}.uk-background-primary{background-color:#49839a!important}.uk-background-secondary{background-color:#37474f!important}@media (min-width:640px){.uk-margin-remove-left\@s{margin-left:0!important}.uk-margin-remove-right\@s{margin-right:0!important}.uk-margin-right\@s{margin-right:20px!important}.uk-margin-left\@s{margin-left:20px!important}.uk-margin-small-top\@s{margin-top:10px!important}.uk-margin-small-bottom\@s{margin-bottom:10px!important}.uk-margin-small-right\@s{margin-right:10px!important}.uk-margin-small-left\@s{margin-left:10px!important}.uk-margin-medium-top\@s{margin-top:40px!important}.uk-margin-medium-bottom\@s{margin-bottom:40px!important}.uk-margin-medium-right\@s{margin-right:40px!important}.uk-margin-medium-left\@s{margin-left:40px!important}.uk-margin-large-top\@s{margin-top:70px!important}.uk-margin-large-bottom\@s{margin-bottom:70px!important}.uk-margin-large-left\@s{margin-left:70px!important}.uk-margin-large-right\@s{margin-right:70px!important}}@media (min-width:960px){.uk-margin-remove-left\@m{margin-left:0!important}.uk-margin-remove-right\@m{margin-right:0!important}.uk-margin-small-top\@m{margin-top:10px!important}.uk-margin-small-bottom\@m{margin-bottom:10px!important}.uk-margin-medium-top\@m{margin-top:40px!important}.uk-margin-medium-bottom\@m{margin-bottom:40px!important}.uk-margin-large-top\@m{margin-top:70px!important}.uk-margin-large-bottom\@m{margin-bottom:70px!important}.uk-margin-medium-left\@m{margin-left:40px!important}.uk-margin-medium-right\@m{margin-right:40px!important}.uk-margin-large-left\@m{margin-left:70px!important}.uk-margin-large-right\@m{margin-right:70px!important}}@media (min-width:1200px){.uk-margin-remove-left\@l{margin-left:0!important}.uk-margin-remove-right\@l{margin-right:0!important}.uk-margin-small-top\@l{margin-top:10px!important}.uk-margin-small-bottom\@l{margin-bottom:10px!important}.uk-margin-medium-top\@l{margin-top:40px!important}.uk-margin-medium-bottom\@l{margin-bottom:40px!important}.uk-margin-large-top\@l{margin-top:70px!important}.uk-margin-large-bottom\@l{margin-bottom:70px!important}}@media (min-width:640px){.uk-padding-remove-left\@s{padding-left:0!important}.uk-padding-remove-right\@s{padding-right:0!important}.uk-padding-small-top\@s{padding-top:10px!important}.uk-padding-small-bottom\@s{padding-bottom:10px!important}.uk-padding-medium-top\@s{padding-top:40px!important}.uk-padding-medium-bottom\@s{padding-bottom:40px!important}.uk-padding-large-top\@s{padding-top:70px!important}.uk-padding-large-bottom\@s{padding-bottom:70px!important}}@media (min-width:960px){.uk-padding-remove-left\@m{padding-left:0!important}.uk-padding-remove-right\@m{padding-right:0!important}.uk-padding-small-top\@m{padding-top:10px!important}.uk-padding-small-bottom\@m{padding-bottom:10px!important}.uk-padding-medium-top\@m{padding-top:40px!important}.uk-padding-medium-bottom\@m{padding-bottom:40px!important}.uk-padding-large-top\@m{padding-top:70px!important}.uk-padding-large-bottom\@m{padding-bottom:70px!important}}@media (min-width:1200px){.uk-padding-remove-left\@l{padding-left:0!important}.uk-padding-remove-right\@l{padding-right:0!important}.uk-padding-small-top\@l{padding-top:10px!important}.uk-padding-small-bottom\@l{padding-bottom:10px!important}.uk-padding-medium-top\@l{padding-top:40px!important}.uk-padding-medium-bottom\@l{padding-bottom:40px!important}.uk-padding-large-top\@l{padding-top:70px!important}.uk-padding-large-bottom\@l{padding-bottom:70px!important}}.sc-only span{font-size:1!important;line-height:1!important;text-indent:-1px;position:absolute;width:0;height:0;padding:0;margin:-1000px;overflow:hidden;border:0}.uk-button{border-radius:3px;font-family:Maven Pro,Helvetica,Arial,sans-serif!important}.uk-button-success{background-color:#4caf50;color:#fff!important}.uk-button-success:hover{background-color:#388e3c;color:#eceff1!important}.card-brand{border-top:3px solid #f8981c}.text-background{line-height:1.75em;padding:2px 10px;color:#3c3c3c!important;border-radius:3px;white-space:nowrap!important}.text-background-red{background-color:rgba(255,205,210,.5)}.text-background-orange{background-color:rgba(255,224,178,.5)}.text-background-yellow{background-color:rgba(255,249,196,.5)}.text-background-green{background-color:rgba(200,230,201,.5)}.text-background-blue{background-color:rgba(187,222,251,.5)}.text-background-indigo{background-color:rgba(232,234,246,.5)}.text-background-violet{background-color:rgba(243,229,245,.5)}section h4.uk-heading-line{font-size:1.15rem;font-weight:700!important;font-family:Maven Pro,sans-serif!important}section h5.{font-size:1rem;font-weight:600!important;margin:0 auto 12px!important}@media (min-width:640px){section h4.uk-heading-line,section h5{font-size:1.25rem}}@media (min-width:768px){section h4.uk-heading-line{font-size:1.25rem}section h5{font-size:1rem}}html{font-size:16px!important}@media screen and (min-width:640px){html{font-size:calc(16px + 6*(100vw - 320px)/680)!important}}@media screen and (min-width:1000px){html{font-size:18px!important}}h1,h3{font-weight:400!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important}h4,h5,li,p{font-weight:400;-webkit-font-kerning:normal;font-kerning:normal}h2,h4,h5,li,p{font-family:Open Sans,Helvetica,sans-serif}h2{font-size:1.5rem;margin-bottom:0!important;padding-bottom:0!important;font-weight:400!important}h2.content-title,header h2{font-family:Maven Pro,Helvetica,Arial,sans-serif!important;font-weight:500!important}.content-lead,h2.content-title{text-align:left}.content-lead{font-size:1.125rem!important;color:#6c6c6c}@media (min-width:640px){h2.content-title{padding-left:50px;padding-right:50px}.content-lead,h2.content-title{text-align:center}}.uk-article-meta{font-size:10px!important}h3.uk-card-title{font-weight:400!important}@media (min-width:640px){h2{font-size:1.55rem!important}.header-lead{font-size:1.35rem!important}}@media (min-width:960px){h2{font-size:1.75rem!important}.header-lead{font-size:1.5rem!important}}h5{padding-bottom:6px!important;font-weight:600!important}h5,h6{margin-bottom:0!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important}h6{font-size:.879rem;padding-bottom:0!important;font-weight:400!important}.uk-breadcrumb li a,.uk-breadcrumb li span{font-size:11px!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important}.uk-breadcrumb li span{font-weight:600!important}.uk-breadcrumb>:nth-child(n+2):not(.uk-first-column):before{content:"/";display:inline-block;margin:0 8px;color:#aaa}h3.uk-section-title{font-size:1.35rem;margin:50px auto 35px!important;font-weight:400!important}.uk-h1,.uk-h2,.uk-h3,.uk-h4{font-family:Maven Pro,Helvetica,Arial,sans-serif!important;font-weight:500!important}.uk-h6{font-size:10px!important;text-transform:uppercase!important}header.hero-cta{height:40%;min-height:600px}.uk-slideshow-items{min-height:600px!important;height:40%!important}p.case-study-label{font-weight:400!important;font-family:Maven Pro,Helvetica,Arial,sans-serif!important;text-transform:uppercase;color:#fff!important}.case-study-header-title{font-size:1.75rem!important;font-weight:600!important;color:#fff!important}.uk-button.pink{color:pink!important}@media (max-width:640px){header{height:200px!important;min-height:200px!important}p.case-study-label{font-weight:400!important;text-transform:uppercase;color:#fff!important;font-size:7px}.uk-slideshow-items{min-height:200px!important;height:200px!important}.case-study-header-title{font-size:12px!important;font-weight:600!important;margin:0!important;padding:0!important}.uk-button-small{font-size:9px!important;line-height:9px!important;margin:5px auto!important;padding:5px!important}}.page-header h2{font-size:1.5rem!important;font-weight:500!important}.page-header p{font-size:1.25rem!important;font-weight:200!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important}@media (min-width:640px){.page-header{text-align:left}.page-header h2{font-size:2.25rem!important;font-weight:500!important}}.post-content h2{font-family:Maven Pro,Helvetica,Arial,sans-serif!important;font-weight:500!important;margin-top:32px!important;margin-bottom:16px!important}.post-content h5{font-size:1.125rem;margin:0;padding:1em 0}.post-content h6{text-align:center;font-weight:600;margin:0;padding:1em 0}.post-content p{margin:0 0 .75rem;padding:0}.post-content a{color:#000;text-decoration:underline}.post-content a.uk-button{color:#fff;text-decoration:none}.post-content em{color:#666}.post-content p>img+em{display:block;width:100%;text-align:center!important;font-size:14px!important;margin-top:.5em}.post-content blockquote{padding-left:48px;padding-right:48px}.post-content blockquote h3{color:#666!important;font-weight:400}.post-content hr{margin:0}.post-content .content-box{border:1px solid #d9d9d9;border-radius:3px;padding:25px!important}.blogMainImage{width:100%;object-fit:cover;object-position:center}.contentEmbed{padding:0;margin:30px 0;border-top:1px solid #d9d9d9;border-bottom:1px solid #d9d9d9}footer,footer h3{margin:0;padding:0}label{margin-top:35px!important;font-size:.879rem}.contact-form h4{color:#fff!important}.uk-notification-message{background-color:#1d1f21}.uk-notification-message,.uk-notification-message-danger{font-size:16px;text-align:center;color:#dfdfdf;border-radius:3px;box-shadow:2px 2px 10px rgba(0,0,0,.3)}.uk-notification-message-danger{background-color:#e53935}.email-received,.uk-modal-dialog{position:absolute!important;z-index:1001!important;top:0!important;left:0!important;right:0!important;bottom:0!important;height:100%!important;width:100%!important;background-color:#49839a!important}.top-wrap-height{height:80vh!important;min-height:460px;-webkit-transition:height .25s;transition:height .25s}.about-section h1{font-size:1.65rem}.about-section p.uk-text-lead{font-size:1.25rem;font-weight:400!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important;color:#666}.about-profile-header{width:100%}img.bio-image{min-width:100vw;height:100%!important;object-fit:cover!important}.about-profile-content p{padding-left:48px!important;padding-right:48px!important}@media (min-width:640px){.about-profile-content p{padding-left:160px!important;padding-right:160px!important}}section.modal-bio{border-style:none;overflow-y:scroll;-webkit-overflow-scrolling:touch}section.modal-bio .uk-close{position:absolute;top:60px!important;right:0!important;z-index:1}section.modal-bio button section.modal-bio a{margin-bottom:102px}.skills-tabs a{font-size:.75rem;font-weight:400}.skills-tabs .uk-tab:before{border-style:none!important}.skills-case-study-buttons a{margin-right:16px!important}.skills-tabs .uk-active a{color:#888!important;border-width:2px;border-color:#f8981c!important}.skills-tabs{margin:32px auto}.skills-content img{object-fit:cover!important;width:100%}.skills-content{box-shadow:0 30px 40px -20px rgba(0,0,0,.05)}.skills-content ul{padding:0!important;background-color:initial;line-height:1em}.skills-content ul li{padding:8px 0;font-size:.879em}.skills-content ul li:hover{background-color:#f8f8f8}.skills-content ul li small{color:#999}.skills-content .uk-card,.skills-content .uk-card-header{border-radius:4px 4px 0 0!important}.skills-content .uk-card-header p{color:#37474f;font-family:Maven Pro,serif;font-weight:600;text-transform:capitalize;text-align:center}.skills-content .case-study-list a{display:block;text-decoration:none;color:#666}.skills-section h4{margin-bottom:14px!important}.skills-section h4,.skills-section h5{font-family:Open Sans,Helvetica,Arial,sans-serif!important}.skills-section h5{color:#6c6c6c!important;margin:0 auto 12px!important;font-weight:400!important}.skills-section .uk-text-lead{font-weight:300}.skills-content li{font-family:Open Sans,Helvetica,Arial,sans-serif!important;color:#6c6c6c!important;margin:0 auto 6px!important}.mobile-skills-content-box{position:relative;background-color:#fff;margin:-64px 12px 40px!important;padding:16px!important;box-shadow:0 3px 10px 0 rgba(0,0,0,.1)}.case-study-link{font-size:.75rem;color:#999}.client-grid img{filter:grayscale(100%) opacity(70%);-webkit-filter:grayscale(100%) opacity(70%);-webkit-transition:-webkit-filter .75s;transition:-webkit-filter .75s;transition:filter .75s;transition:filter .75s,-webkit-filter .75s}.client-grid img:hover{filter:grayscale(0) opacity(100%);-webkit-filter:grayscale(0) opacity(100%)}.testimonials li p.uk-text-large{font-size:1.2rem!important;margin-bottom:1.5rem;font-family:Bitter,Georgia,Garamond,Times New Roman,serif;font-style:italic}.testimonials li p{font-size:12px;margin:0;padding:0}.portfolio-list small{font-size:12px!important;color:#ababab!important;padding:0!important}.portfolio-items .uk-card-media-top img{border-radius:2px}.portfolio-items .uk-h3{font-weight:500!important}.portfolio-header{text-align:left}@media (min-width:640px){.portfolio-header{text-align:center}}.portfolio-detail h5{font-family:Maven Pro,Helvetica,Arial,sans-serif!important;font-weight:500!important;margin-top:32px!important;margin-bottom:16px!important}.portfolio-detail .uk-label{font-size:9px!important;background-color:#f8f8f8!important;color:#90a4ae!important}.portfolio-detail h5:first-child{padding-top:0!important}.contentEmbed{margin-top:0!important;border-style:none!important}#priceModule .uk-card-header{font-size:1.5rem!important;font-weight:200;color:#000;border-style:none}#priceModule h3{font-size:1.275rem}.service-cost{font-size:1.75rem;font-weight:100}.service-cost span{font-size:3.5rem;font-weight:200;color:#333}.rates-content i{color:#f8981c;margin-top:24px!important}article,aside{padding-left:20px;padding-right:20px}aside{padding-bottom:100px}article{padding-bottom:35px}aside progress{margin-top:0!important}.skills-list h3,.work-experience h3{margin-top:50px!important;text-transform:uppercase;font-weight:400}.skills-list h3:first-child,.work-experience h3:first-child{margin-top:0!important}.uk-article-meta{font-size:12px!important}article h5,aside.skills-list h5{text-transform:uppercase;font-weight:500;font-size:12px!important}aside.skills-list .uk-text-small{font-size:11px!important}article .title{margin-bottom:15px}.work-experience .uk-article-title{margin-top:35px;font-size:1.5rem!important;font-family:Open Sans,Helvetica,Arial,sans-serif!important;color:#2c2c2c}.work-experience .uk-article-meta{font-family:Open Sans,Helvetica,Arial,sans-serif!important;text-transform:uppercase;margin:0!important;padding:0!important}.work-experience .uk-text-lead{font-size:1.124rem!important}.uk-progress{height:3px!important;margin-bottom:.5rem;background-color:rgba(0,0,0,.23)}*+.uk-progress{margin-top:.25rem}.uk-progress.one::-webkit-progress-value{background-color:#26c6da}.uk-progress.one::-moz-progress-bar{background-color:#26c6da}.uk-progress.one::-ms-fill{background-color:#26c6da}.uk-progress.two::-webkit-progress-value{background-color:#faa05a}.uk-progress.two::-moz-progress-bar{background-color:#faa05a}.uk-progress.two::-ms-fill{background-color:#faa05a}.uk-progress.three::-webkit-progress-value{background-color:#32d296}.uk-progress.three::-moz-progress-bar{background-color:#32d296}.uk-progress.three::-ms-fill{background-color:#32d296}.uk-progress.four::-webkit-progress-value{background-color:#9c27b0}.uk-progress.four::-moz-progress-bar{background-color:#9c27b0}.uk-progress.four::-ms-fill{background-color:#9c27b0}.uk-progress.five::-webkit-progress-value{background-color:#ef5350}.uk-progress.five::-moz-progress-bar{background-color:#ef5350}.uk-progress.five::-ms-fill{background-color:#ef5350}.uk-progress.six::-webkit-progress-value{background-color:#90a4ae}.uk-progress.six::-moz-progress-bar{background-color:#90a4ae}.uk-progress.six::-ms-fill{background-color:#90a4ae}</style><meta name="generator" content="Gatsby 2.19.16"/><title data-react-helmet="true">Using Python and Pandas With Google BigQuery.</title><link data-react-helmet="true" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.0.3/css/uikit.min.css"/><script data-react-helmet="true" async="" src="//cdn.embedly.com/widgets/platform.js" charSet="UTF-8"></script><link rel="icon" href="/icons/icon-48x48.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#37474f"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=55610aeb3dd863a2e1d4c2fae0739ff8"/><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link as="script" rel="preload" href="/webpack-runtime-9396407c8101c41a5b7c.js"/><link as="script" rel="preload" href="/app-e1cb72a636ec3c10d813.js"/><link as="script" rel="preload" href="/styles-54001d8a54d9266fe5ef.js"/><link as="script" rel="preload" href="/commons-928da970d8a349279f77.js"/><link as="script" rel="preload" href="/component---src-templates-blog-detail-js-28362a831d66459b2943.js"/><link as="fetch" rel="preload" href="/page-data/blog/python-pandas-google-bigquery/page-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="navbar-container" data-uk-sticky="true"><div class="anim-nav-container uk-hidden@s" style="background:rgb(236, 239, 241, 0);width:80px;height:60px;z-index:1000"><div style="margin-top:8px" class="uk-padding-small uk-position-fixed uk-position-z-index"><span class="uk-float-left false" data-uk-icon="icon: menu; ratio: 0.9"></span><small class="uk-float-left uk-text-middle false"> Â <!-- -->MENU</small></div></div><nav class="uk-navbar-container" data-uk-navbar="true"><div class="uk-navbar-center uk-hidden@s"><a class="uk-navbar-item uk-logo" href="/"><img src="/static/astro-logo-3658d8d298d3420a1167cc5934bc3ca7.svg" width="60px" alt="Astro Logo" data-uk-image="true"/></a></div><div class="uk-navbar-left uk-margin-medium-left uk-visible@s"><a class="home-icon uk-link-muted uk-link-reset" href="/"><i data-uk-icon="icon: arrow-left; ratio: 0.95;"></i><i data-uk-icon="icon: home; ratio: 0.75;"></i></a></div><div class="uk-navbar-center uk-margin-medium-right uk-visible@s"><ul class="uk-navbar-nav"><li><a href="/portfolio">Work</a></li><li><a href="/resume">Resume</a></li><li><a class="uk-navbar-item uk-logo uk-visible@s" href="/"><img src="/static/astro-logo-3658d8d298d3420a1167cc5934bc3ca7.svg" width="55px" alt="Astro logo" data-uk-image="true"/></a></li><li><a href="/blog">Waste</a></li><li><a href="/contact">Contact</a></li></ul></div></nav></div><section class="uk-section uk-article"><div class="uk-container uk-container-small"><p class="uk-text-bold uk-h2 uk-margin-remove-adjacent uk-margin-remove-top">Using Python and Pandas With Google BigQuery.</p><p class="uk-article-meta">Posted on <!-- -->March 30, 2019</p><p class="uk-text-lead uk-margin-bottom">In this &quot;how to&quot;, we&#x27;ll be using Django to query a dataset, format that data using Pandas, then pushing the DataFrame to Google BigQuery as our data warehouse.</p></div><div class="post-content uk-container uk-container-small"><p>Influen$e relies heavily on data generated through multiple micro-services and API calls, all in real time. Early on, I wanted to set up the platform to use Google BigQuery for data warehousing, allowing us to work with real-time data in smaller chunks.</p><div><section class="uk-section uk-section-small">
	<div class="content-box uk-container uk-container-small uk-padding-small uk-width-1-2@s">
		<h4 class="uk-text-center">Shortcut this</h4>
		<h5 class="uk-text-center">
            If you know what you're doing, you can get the code from GitHub.
        </h5>
		<div class="uk-text-center">
			<a class="uk-button uk-button-large uk-button-secondary"
                href="https://github.com/MichaelLisboa/python-pandas-bigquery">
				Get it on GitHub
			</a>
		</div>
	</div>
</section></div><h4>Trying to make a complicated set up as easy as possible to implement.</h4><p>When I first started researching how to do this, it all seemed really complicated. I was scouring the web and reading articles, pulling little bits of useful information from many different sources.</p><p>In the end, I came up with a hacked together solution that I refined down to, what I believe, is the simplest execution.</p><h5>What we&#x27;re going to do.</h5><ol><li>Query data in Django.</li><li>Model that data, using Pandas, to a workable DataFrame.</li><li>Push the data to Google BigQuery.</li><li>Create a Cron job to run nightly pushes.</li></ol><p>While this is a real-world example, the point of this exercise is to get a basic understanding of the steps required for setting it all up. So, I&#x27;ll simplify things by only using a single query.</p><h4>Setting up Google BigQuery.</h4><p>I&#x27;m going to skip setting up a Google Cloud project, assuming you&#x27;ve already made it this far. We&#x27;ll start with getting BigQuery set up.</p><p>First, you need to go <a title="Google BigQuery API" href="https://console.cloud.google.com/flows/enableapi?apiid=bigquery&amp;_ga=2.182927334.-1396141278.1552049696&amp;pli=1&amp;angularJsUrl=%2Fflows%2Fenableapi%3Fapiid%3Dbigquery%26_ga%3D2.182927334.-1396141278.1552049696%26pli%3D1&amp;authuser=1">here and enable the API in your Google Project</a></p><p>Google has a really really good walkthrough of <a title="BigQuery quick start" href="https://cloud.google.com/bigquery/docs/quickstarts/quickstart-web-ui">setting up the environment here.</a></p><p>Once you have the API setup in your project, an option for BigQuery should be present in your console menu. There you&#x27;ll see a screen like this:</p><p><img alt="gbq-step-1" src="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png"/></p><h5>Create a DataSet</h5><p>Clicking on the &quot;Create Dataset&quot; button will display this screen:</p><p><img alt="gbq-step-2" src="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png"/></p><p>Name your DataSet, in this case I&#x27;m calling it <code>MyDataId</code>, and choose the zone closest to you. For me, I&#x27;ve selected Singapore. Go ahead and click the Create DataSet button to get your first DataSet set up in BigQuery.</p><p>Now that we have a DataSet, we need to add tables to it. To keep things simple, we&#x27;re going to add only one table. Select your <code>MyDataId</code>, and click Create Table to add a new empty table and call it <code>MyDataTable</code>. Don&#x27;t worry about other settings at the moment, an empty table that&#x27;s editable as text works for our case.</p><p><img alt="gbq-step-5" src="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png"/></p><p>Okay, we now have a DataSet with an empty table set up. We&#x27;ll be able to reference our table in Python using <code>MyDataId.MyDataTable</code>.</p><h5>Let&#x27;s make our Django View.</h5><p>Go to your Django app <code>views.py</code> and create a new function. I&#x27;m calling it <code>push_bigquery()</code>. We&#x27;ll start with creating a queryset for &quot;MyMembers&quot;:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">Count</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">functions</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">TruncDate</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">http</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">HttpResponse</span>

<span class="token module" style="color:#cc7832">import</span> pandas <span class="token module" style="color:#cc7832">as</span> pd
<span class="token module" style="color:#cc7832">from</span> common<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">MyMembersModel</span>


def <span class="token" style="color:#ffc66d">push_bigquery</span><span class="token" style="color:#a9b7c6">(</span>request<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">:</span>
    members_qs <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        <span class="token maybe-class-name">MyMembersModel</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token property-access">objects</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">prefetch_related</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;profile__thing&quot;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">annotate</span><span class="token" style="color:#a9b7c6">(</span>
            created_date<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">TruncDate</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;profile__thing__timestamp&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
            count<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">Count</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">order_by</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">distinct</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">values</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;slug&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
    
members_df <span class="token" style="color:#a9b7c6">=</span> pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d"><span class="token maybe-class-name">DataFrame</span></span><span class="token" style="color:#a9b7c6">(</span>members_qs<span class="token" style="color:#a9b7c6">)</span></code></pre><p>What we&#x27;ve done here is query our <code>MyMembers</code> table and related <code>Things</code>, as <code>values()</code>, which will return a <code>dict</code>-like queryset.</p><p>Sidenote, I&#x27;m also truncating the timstamp using <code>TruncDate</code>, which casts the expression to a date rather than using the built-in SQL <code>truncate</code> method.</p><p>Then we create our Pandas DataFrame from the values with <code>members_df = pd.DataFrame(members_qs)</code></p><h5>Basic data modeling.</h5><p>We&#x27;re going to do some simple modeling to format our DataFrame. Again, we&#x27;re keeping this simple, I&#x27;m assuming you&#x27;re already knowledgable about formatting data with Pandas.</p><p>Add the following to your function:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_datetime</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span>
members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">set_index</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">,</span> inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span>axis<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
    members_df
    <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">index</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span>
    <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
<span class="token" style="color:#a9b7c6">)</span>

members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;frequency_of_thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">/</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">*</span> <span class="token" style="color:#6897bb">100</span>
<span class="token" style="color:#a9b7c6">)</span></code></pre><p>I&#x27;ve started by converting the <code>created_date</code> series to datetime and set it as the index.</p><p>Then we&#x27;re getting the cumulative sum of the number of &quot;things&quot;, and cumulative sum of &quot;labels&quot; associated with &quot;things&quot;. And finally the cumulative sum of &quot;things&quot; by each &quot;member&quot;.</p><p>Yeah, I know that sounds really confusing...</p><p>We&#x27;re doing this because we&#x27;re looking to get the frequency of things <code>members_df[&#x27;frequency_of_thing&#x27;]</code> by individual members and comparing that to the whole community.</p><p>Next we want to format our DataFrame by selecting the Series&#x27; we want, filtering out any NaN values and resetting the index:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>
    <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;slug&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;frequency_of_thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span>
<span class="token" style="color:#a9b7c6">]</span>
members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">notnull</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">]</span>
members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">reset_index</span><span class="token" style="color:#a9b7c6">(</span>inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>Okay, our <code>members_df</code> is where we want it so we can push it to BigQuery. You&#x27;ll find this frustratingly simple:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_gbq</span><span class="token" style="color:#a9b7c6">(</span>
    <span class="token" style="color:#6a8759">&#x27;MyDataId.MyDataTable&#x27;</span><span class="token" style="color:#a9b7c6">,</span>
    project_id<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&#x27;your-gcp-project&#x27;</span><span class="token" style="color:#a9b7c6">,</span>
    if_exists<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&#x27;replace&#x27;</span>
<span class="token" style="color:#a9b7c6">)</span></code></pre><p>That&#x27;s it.</p><p>We&#x27;re using Pandas <code>to_gbq</code> to send our DataFrame to BigQuery.</p><ul><li><code>&#x27;MyDataId.MyDataTable&#x27;</code> references the DataSet and table we created earlier.</li><li><code>project_id</code> is obviously the ID of your Google Cloud project.</li><li><code>if_exists</code> is set to replace the content of the BigQuery table if the table already exists.</li></ul><h5>About if_exists.</h5><p>In this case, if the table already exists in BigQuery, we&#x27;re replacing all of the data. You don&#x27;t want to do that in the real world. </p><p><code>if_exists</code> has a couple of other arguments,</p><ul><li><code>fail</code>, which raises an exception if you try to write to the table, and</li><li><code>append</code> which is our preferred option in this case, which will append your data to the existing table.</li></ul><h5>One other thing</h5><p>In my case, not only do I want to push all my data to BigQuery, I also wanted a subset of that data for fast lookups across different services. To do this I pickeled the last 3 months of my dataset with:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none">members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">last</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;3M&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_pickle</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;members_df.pkl&#x27;</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>Our final function looks like this:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">Count</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">db</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">functions</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">TruncDate</span>
<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">http</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">HttpResponse</span>

<span class="token module" style="color:#cc7832">import</span> pandas <span class="token module" style="color:#cc7832">as</span> pd
<span class="token module" style="color:#cc7832">from</span> common<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">models</span> <span class="token module" style="color:#cc7832">import</span> <span class="token maybe-class-name">MyMembersModel</span>


def <span class="token" style="color:#ffc66d">push_bigquery</span><span class="token" style="color:#a9b7c6">(</span>request<span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">:</span>
    members_qs <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        <span class="token maybe-class-name">MyMembersModel</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token property-access">objects</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">prefetch_related</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&quot;profile__thing&quot;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">annotate</span><span class="token" style="color:#a9b7c6">(</span>
            created_date<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">TruncDate</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;profile__thing__timestamp&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
            count<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#ffc66d"><span class="token maybe-class-name">Count</span></span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">order_by</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">)</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">distinct</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
      <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">values</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;slug&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">)</span>

    members_df <span class="token" style="color:#a9b7c6">=</span> pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d"><span class="token maybe-class-name">DataFrame</span></span><span class="token" style="color:#a9b7c6">(</span>members_qs<span class="token" style="color:#a9b7c6">)</span>

    pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_datetime</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span>
    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">set_index</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;created_date&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">,</span> inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span>axis<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">0</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;count&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        members_df
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">groupby</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">index</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;profile__thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span>
        <span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">cumsum</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#a9b7c6">)</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;frequency_of_thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">(</span>
        members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">/</span> members_df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span> <span class="token" style="color:#a9b7c6">*</span> <span class="token" style="color:#6897bb">100</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>
        <span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;name&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;slug&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;label_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">,</span> <span class="token" style="color:#6a8759">&#x27;frequency_of_thing&#x27;</span><span class="token" style="color:#a9b7c6">]</span>
    <span class="token" style="color:#a9b7c6">]</span>
    members_df <span class="token" style="color:#a9b7c6">=</span> members_df<span class="token" style="color:#a9b7c6">[</span>pd<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">notnull</span><span class="token" style="color:#a9b7c6">(</span>df<span class="token" style="color:#a9b7c6">[</span><span class="token" style="color:#6a8759">&#x27;thing_cumsum&#x27;</span><span class="token" style="color:#a9b7c6">]</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">]</span>
    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">reset_index</span><span class="token" style="color:#a9b7c6">(</span>inplace<span class="token" style="color:#a9b7c6">=</span><span class="token maybe-class-name">True</span><span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_gbq</span><span class="token" style="color:#a9b7c6">(</span>
        <span class="token" style="color:#6a8759">&#x27;MyDataId.MyDataTable&#x27;</span><span class="token" style="color:#a9b7c6">,</span>
        project_id<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&#x27;your-gcp-project&#x27;</span><span class="token" style="color:#a9b7c6">,</span>
        if_exists<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6a8759">&#x27;replace&#x27;</span>
    <span class="token" style="color:#a9b7c6">)</span>

    members_df<span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">last</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;3M&#x27;</span><span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">.</span><span class="token method property-access" style="color:#ffc66d">to_pickle</span><span class="token" style="color:#a9b7c6">(</span><span class="token" style="color:#6a8759">&#x27;members_df.pkl&#x27;</span><span class="token" style="color:#a9b7c6">)</span>

    <span class="token" style="color:#cc7832">return</span> <span class="token" style="color:#ffc66d"><span class="token maybe-class-name">HttpResponse</span></span><span class="token" style="color:#a9b7c6">(</span>status<span class="token" style="color:#a9b7c6">=</span><span class="token" style="color:#6897bb">200</span><span class="token" style="color:#a9b7c6">)</span></code></pre><p>We could do a bit more optimization with Pandas and Threading, but this is good enough for the purpose of this article.</p><h5>Google Cloud App Engine <!-- -->&amp;<!-- --> Cron jobs</h5><p>We&#x27;re going to set up a Cron job on Google App Engine to run our BigQuery program nightly.</p><p>Let&#x27;s create a url pattern for our <code>push_bigquery</code> view and add it to the app urls.py:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"># app<span class="token" style="color:#a9b7c6">/</span>urls<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">py</span>

<span class="token module" style="color:#cc7832">from</span> django<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">conf</span><span class="token" style="color:#a9b7c6">.</span><span class="token property-access">urls</span> <span class="token module" style="color:#cc7832">import</span> url

<span class="token module" style="color:#cc7832">from</span> <span class="token" style="color:#a9b7c6">.</span> <span class="token module" style="color:#cc7832">import</span> views

urlpatterns <span class="token" style="color:#a9b7c6">=</span> <span class="token" style="color:#a9b7c6">[</span>

    <span class="token spread" style="color:#a9b7c6">...</span> other url patterns <span class="token spread" style="color:#a9b7c6">...</span>
    
    <span class="token method property-access" style="color:#ffc66d">url</span><span class="token" style="color:#a9b7c6">(</span>
        r<span class="token" style="color:#6a8759">&#x27;^push-gbq/$&#x27;</span><span class="token" style="color:#a9b7c6">,</span>
        views<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">push_bigquery</span>
    <span class="token" style="color:#a9b7c6">)</span><span class="token" style="color:#a9b7c6">,</span>
<span class="token" style="color:#a9b7c6">]</span></code></pre><p>Now you should be able to visit <a href="http://localhost:8000/push-gbq/">http://localhost:8000/push-gbq/</a> and the function will run, cerating the DataFrame, pushing it to BigQuery, and pickeling your DataFrame.</p><p>To make sure it works, take a look at BigQuery in your Google Cloud Console. You should see your table update with your data. Also, you should see a new <code>.pkl</code> file called &quot;members_df.pkl&quot; in your local project root directory.</p><p>Next, in your project root directory, create a file called <code>cron.yaml</code> and add this:</p><pre style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1em;margin:.5em 0;overflow:auto;background:#2b2b2b"><code style="color:#a9b7c6;font-family:Consolas, Monaco, &#x27;Andale Mono&#x27;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"># root<span class="token" style="color:#a9b7c6">/</span>cron<span class="token" style="color:#a9b7c6">.</span><span class="token property-access">yaml</span>

cron<span class="token" style="color:#a9b7c6">:</span>
<span class="token" style="color:#a9b7c6">-</span> description<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6a8759">&quot;Push GBQ CRON&quot;</span>
  url<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="background:#364135"><span class="token regex-delimiter">/</span><span class="token language-regex">push-gbq</span><span class="token regex-delimiter">/</span></span>
  schedule<span class="token" style="color:#a9b7c6">:</span> every <span class="token" style="color:#6897bb">24</span> hours
  retry_parameters<span class="token" style="color:#a9b7c6">:</span>
    min_backoff_seconds<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6897bb">120</span>
    max_doublings<span class="token" style="color:#a9b7c6">:</span> <span class="token" style="color:#6897bb">5</span></code></pre><p>This creates a Cron job for App Engine that will visit your push_bigquery function at <code>www.your-website/push-gbq/</code> every 24 hours to push your latest data to BigQuery. Depending on your situation, you&#x27;ll probably want to change the frequency this runs in your <code>cron.yaml</code> file.</p><p>Push the Cron job to App Engine with this terminal command:</p><p><code>gcloud app deploy cron.yaml</code></p><h5>Security</h5><p>Make sure you set up your function to only accept requests with the <code>x-appengine-cron</code> header!</p><p>Now you can deploy your project <code>gcloud app deploy</code> and test your Cron job by clicking the &quot;Run now&quot; button on your Cron page in Google Console.</p></div><div class="uk-container uk-container-small uk-margin-medium"><div class="uk-grid uk-grid-medium uk-child-width-1-2 uk-child-width-1-3@s" data-uk-grid="true" data-uk-lightbox="true"><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/1Lq8v6SU2cElAFp8KD8Aoo/356cf0a9e7bc4516a69e4469aae19ecd/gbq-step-1.png" width="300" alt="gbq-step-1" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/cTzGLGf0wk0RV7QAIa5J1/fbf739ee665c0c3fc066bd22fbf533aa/gbq-step-2.png" width="300" alt="gbq-step-2" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/7tewmCE7oJX0jzFN3E5wKk/f86a63c1b3dd3290298d48847615ccb3/gbq-step-3.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/7tewmCE7oJX0jzFN3E5wKk/f86a63c1b3dd3290298d48847615ccb3/gbq-step-3.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/7tewmCE7oJX0jzFN3E5wKk/f86a63c1b3dd3290298d48847615ccb3/gbq-step-3.png" width="300" alt="gbq-step-3" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/2qeKMLyRhLW0q7hUgdoHgc/8f3306427756afc303e4f77991979d57/gbq-step-4.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/2qeKMLyRhLW0q7hUgdoHgc/8f3306427756afc303e4f77991979d57/gbq-step-4.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/2qeKMLyRhLW0q7hUgdoHgc/8f3306427756afc303e4f77991979d57/gbq-step-4.png" width="300" alt="gbq-step-4" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/8laAGPcPtJaWstNVCI0iQ/e252e3f144870a0743c5da5780aa417a/gbq-step-5-detail.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/8laAGPcPtJaWstNVCI0iQ/e252e3f144870a0743c5da5780aa417a/gbq-step-5-detail.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/8laAGPcPtJaWstNVCI0iQ/e252e3f144870a0743c5da5780aa417a/gbq-step-5-detail.png" width="300" alt="gbq-step-5-detail" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/IZGItB3zAIT8qPBVj0Uz0/a46b41bb175fd7fb40d3f3894320f8a2/gbq-step-5.png" width="300" alt="gbq-step-5" data-uk-img="true"/></a></figure></div><div><figure><a href="//images.ctfassets.net/1nc0h0ipk4bl/1joeSzZgWNLbVImOGggaFV/0e89161ef0519856d8ac3a2618776b1e/gbq-step-6.png"><img src="//images.ctfassets.net/1nc0h0ipk4bl/1joeSzZgWNLbVImOGggaFV/0e89161ef0519856d8ac3a2618776b1e/gbq-step-6.png" data-src="//images.ctfassets.net/1nc0h0ipk4bl/1joeSzZgWNLbVImOGggaFV/0e89161ef0519856d8ac3a2618776b1e/gbq-step-6.png" width="300" alt="gbq-step-6" data-uk-img="true"/></a></figure></div></div></div></section><section class="contact-section uk-section uk-section-expand uk-background-secondary uk-light"><div class="uk-container uk-container-small" data-uk-scrollspy="cls: uk-animation-slide-bottom-medium; target: div &gt; *; repeat: true;"><div class="uk-width-3-5@s"><p class="uk-h6 uk-text-muted uk-margin-small-bottom uk-text-uppercase"><strong>â</strong> Let&#x27;s do great things</p><p class="uk-h2 uk-margin-remove-top"><span class="uk-margin-bottom uk-display-block">Get in touch to talk about your next project.</span></p></div></div></section><section class="uk-section uk-section-expand uk-margin-remove-top uk-padding-remove uk-background-secondary uk-light"><div class="uk-container uk-container-small" uk-scrollspy="cls: uk-animation-fade; delay: 500;"><div class="uk-grid-medium uk-child-width-1-2@m" data-uk-grid="true"><div><p class="uk-h4">Create experiences that people love.</p><p>I work with future-thinking brands, agencies and startups looking to create the next killer product or campaign.</p><p>If that sounds like you, get in touch.</p><div class="uk-width-1-1 uk-margin-medium-top" data-uk-grid="true"><div class="sc-only uk-width-1-1" data-uk-grid="true"><div class="uk-align-left"><a href="https://www.linkedin.com/in/lisboa/" class="uk-icon-button uk-margin-right" data-uk-icon="linkedin"><span>LinkedIn</span></a><a href="http://michael_lisboa.dribbble.com/" class="uk-icon-button uk-margin-right" data-uk-icon="dribbble"><span>Dribbble</span></a><a href="https://github.com/MichaelLisboa" class="uk-icon-button uk-margin-right" data-uk-icon="github"><span>GitHub</span></a><a href="https://www.instagram.com/michael__lisboa/" class="uk-icon-button" data-uk-icon="instagram"><span>Instagram</span></a></div></div></div></div><div><p class="uk-h4"><span class="uk-float-left uk-margin-small-right" data-uk-icon="icon: mail; ratio: 1.75"></span><span>Send an email</span></p><form id="contactForm" class="uk-form"><fieldset class="uk-fieldset"><div class="uk-margin-small-top"><label for="first_name" class="uk-text-muted">First name <input type="text" name="first_name" value="" class="uk-input uk-form-large " maxLength="75" required=""/></label></div><div class="uk-margin-small-top"><label for="last_name" class="uk-text-muted">Last name <input type="text" name="last_name" value="" class="uk-input uk-form-large " maxLength="75" required=""/></label></div><div class="uk-margin-small-top"><label for="from_email" class="uk-text-muted">Email address <input type="text" name="from_email" value="" class="uk-input uk-form-large " maxLength="100" required=""/></label></div><div class="uk-margin-small-top"><label for="comment" class="uk-text-muted">Your message <textarea name="comment" rows="3" class="uk-textarea uk-form-large " maxLength="1000" required=""></textarea></label></div><div class="uk-margin-large-bottom uk-margin-medium-top uk-text-right"><button type="submit" class="uk-button uk-button-large uk-button-default uk-width-1-2 uk-width-1-3@s" disabled="">Send</button></div></fieldset></form></div></div></div></section><footer class="uk-container uk-container-expand uk-margin-remove-top uk-padding-remove uk-background-secondary uk-light"><div class="uk-container uk-container-expand uk-padding-remove uk-margin-remove-vertical"><div class="uk-text-center uk-padding uk-padding-remove-horizontal"><span class="uk-text-small uk-text-light">Â©2020 Michael Lisboa â¢ Â <a href="/contact"><span data-uk-icon="icon: mail; ratio: 0.75"></span>Â Contact me</a></span></div></div></footer></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-137372309-1', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/python-pandas-google-bigquery";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-e1cb72a636ec3c10d813.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-9edabb9556448a6822d1.js"],"component---src-templates-blog-detail-js":["/component---src-templates-blog-detail-js-28362a831d66459b2943.js"],"component---src-templates-portfolio-detail-js":["/component---src-templates-portfolio-detail-js-136726437bb2ba38da3b.js"],"component---src-pages-404-js":["/component---src-pages-404-js-60cca99eea748634fd7a.js"],"component---src-pages-blog-js":["/component---src-pages-blog-js-d37173c0f7af32058598.js"],"component---src-pages-contact-js":["/component---src-pages-contact-js-2c8917a6db607ccc9da0.js"],"component---src-pages-index-js":["/component---src-pages-index-js-c6eb829eb008ccd0a151.js"],"component---src-pages-portfolio-js":["/component---src-pages-portfolio-js-bd820bdf4161c76f2565.js"],"component---src-pages-rates-js":["/component---src-pages-rates-js-829b44ae8b29d9ff9ea3.js"],"component---src-pages-resume-js":["/component---src-pages-resume-js-9e6f46418a3b3ca8fba0.js"]};/*]]>*/</script><script src="/component---src-templates-blog-detail-js-28362a831d66459b2943.js" async=""></script><script src="/commons-928da970d8a349279f77.js" async=""></script><script src="/styles-54001d8a54d9266fe5ef.js" async=""></script><script src="/app-e1cb72a636ec3c10d813.js" async=""></script><script src="/webpack-runtime-9396407c8101c41a5b7c.js" async=""></script></body></html>